/*!
 * jQuery Cookie Plugin v1.4.1
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2006, 2014 Klaus Hartl
 * Released under the MIT license
 */
(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{if(typeof exports==="object"){a(require("jquery"))}else{a(jQuery)}}}(function(f){var a=/\+/g;function d(j){return b.raw?j:encodeURIComponent(j)}function g(j){return b.raw?j:decodeURIComponent(j)}function h(j){return d(b.json?JSON.stringify(j):String(j))}function c(j){if(j.indexOf('"')===0){j=j.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\")}try{j=decodeURIComponent(j.replace(a," "));return b.json?JSON.parse(j):j}catch(k){}}function e(k,j){var l=b.raw?k:c(k);return f.isFunction(j)?j(l):l}var b=f.cookie=function(q,p,v){if(arguments.length>1&&!f.isFunction(p)){v=f.extend({},b.defaults,v);if(typeof v.expires==="number"){var r=v.expires,u=v.expires=new Date();u.setTime(+u+r*86400000)}return(document.cookie=[d(q),"=",h(p),v.expires?"; expires="+v.expires.toUTCString():"",v.path?"; path="+v.path:"",v.domain?"; domain="+v.domain:"",v.secure?"; secure":""].join(""))}var w=q?undefined:{};var s=document.cookie?document.cookie.split("; "):[];for(var o=0,m=s.length;o<m;o++){var n=s[o].split("=");var j=g(n.shift());var k=n.join("=");if(q&&q===j){w=e(k,p);break}if(!q&&(k=e(k))!==undefined){w[j]=k}}return w};b.defaults={};f.removeCookie=function(k,j){if(f.cookie(k)===undefined){return false}f.cookie(k,"",f.extend({},j,{expires:-1}));return !f.cookie(k)}}));(function(a){a.fn.imageSlider=function(l){var e=a.extend({fadeTime:1000,switchTime:5000},l);var j=new Array();a("ul li",this).each(function(){j.push({img:a(this).attr("data-img"),title:a(this).html(),uri:a(this).attr("data-href")})});if(j.length>0){var f=j.length;var g=0;var b=a(this);var d=a("<a></a>").prependTo(b);var k=a("<span></span>").prependTo(d);var c=function(){b.css("background-image","url('"+j[g].img+"')");g=(g!=(f-1)?g+1:0);d.fadeOut(e.fadeTime,function(){d.css("background-image","url('"+j[g].img+"')");d.fadeIn(e.fadeTime);d.attr("href",j[g].uri);k.text(j[g].title)})};var h=setInterval(c,e.switchTime);d.css("background-image","url('"+j[g].img+"')");d.attr("href",j[g].uri);k.text(j[g].title)}return this}}(jQuery));
/*!
 * hoverIntent v1.8.0 // 2014.06.29 // jQuery v1.9.1+
 * http://cherne.net/brian/resources/jquery.hoverIntent.html
 *
 * You may use hoverIntent under the terms of the MIT license. Basically that
 * means you are free to use hoverIntent as long as this header is left intact.
 * Copyright 2007, 2014 Brian Cherne
 */
(function(a){a.fn.hoverIntent=function(n,d,h){var k={interval:100,sensitivity:6,timeout:0};if(typeof n==="object"){k=a.extend(k,n)}else{if(a.isFunction(d)){k=a.extend(k,{over:n,out:d,selector:h})}else{k=a.extend(k,{over:n,out:n,selector:d})}}var m,l,g,f;var e=function(o){m=o.pageX;l=o.pageY};var c=function(p,o){o.hoverIntent_t=clearTimeout(o.hoverIntent_t);if(Math.sqrt((g-m)*(g-m)+(f-l)*(f-l))<k.sensitivity){a(o).off("mousemove.hoverIntent",e);o.hoverIntent_s=true;return k.over.apply(o,[p])}else{g=m;f=l;o.hoverIntent_t=setTimeout(function(){c(p,o)},k.interval)}};var j=function(p,o){o.hoverIntent_t=clearTimeout(o.hoverIntent_t);o.hoverIntent_s=false;return k.out.apply(o,[p])};var b=function(q){var p=a.extend({},q);var o=this;if(o.hoverIntent_t){o.hoverIntent_t=clearTimeout(o.hoverIntent_t)}if(q.type==="mouseenter"){g=p.pageX;f=p.pageY;a(o).on("mousemove.hoverIntent",e);if(!o.hoverIntent_s){o.hoverIntent_t=setTimeout(function(){c(p,o)},k.interval)}}else{a(o).off("mousemove.hoverIntent",e);if(o.hoverIntent_s){o.hoverIntent_t=setTimeout(function(){j(p,o)},k.timeout)}}};return this.on({"mouseenter.hoverIntent":b,"mouseleave.hoverIntent":b},k.selector)}})(jQuery);(function(b){var a=(function(){var p={bcClass:"sf-breadcrumb",menuClass:"sf-js-enabled",anchorClass:"sf-with-ul",menuArrowClass:"sf-arrows"},e=(function(){var c=/iPhone|iPad|iPod/i.test(navigator.userAgent);if(c){b(window).load(function(){b("body").children().on("click",b.noop)})}return c})(),k=(function(){var c=document.documentElement.style;return("behavior" in c&&"fill" in c&&/iemobile/i.test(navigator.userAgent))})(),m=function(s,t){var c=p.menuClass;if(t.cssArrows){c+=" "+p.menuArrowClass}s.toggleClass(c)},r=function(c,s){return c.find("li."+s.pathClass).slice(0,s.pathLevels).addClass(s.hoverClass+" "+p.bcClass).filter(function(){return(b(this).children(s.popUpSelector).hide().show().length)}).removeClass(s.pathClass)},n=function(c){c.children("a").toggleClass(p.anchorClass)},f=function(c){var s=c.css("ms-touch-action");s=(s==="pan-y")?"auto":"pan-y";c.css("ms-touch-action",s)},j=function(t,u){var c="li:has("+u.popUpSelector+")";if(b.fn.hoverIntent&&!u.disableHI){t.hoverIntent(l,g,c)}else{t.on("mouseenter.superfish",c,l).on("mouseleave.superfish",c,g)}var s="MSPointerDown.superfish";if(!e){s+=" touchend.superfish"}if(k){s+=" mousedown.superfish"}t.on("focusin.superfish","li",l).on("focusout.superfish","li",g).on(s,"a",u,h)},h=function(t){var s=b(this),c=s.siblings(t.data.popUpSelector);if(c.length>0&&c.is(":hidden")){s.one("click.superfish",false);if(t.type==="MSPointerDown"){s.trigger("focus")}else{b.proxy(l,s.parent("li"))()}}},l=function(){var c=b(this),s=o(c);clearTimeout(s.sfTimer);c.siblings().superfish("hide").end().superfish("show")},g=function(){var c=b(this),s=o(c);if(e){b.proxy(q,c,s)()}else{clearTimeout(s.sfTimer);s.sfTimer=setTimeout(b.proxy(q,c,s),s.delay)}},q=function(c){c.retainPath=(b.inArray(this[0],c.$path)>-1);this.superfish("hide");if(!this.parents("."+c.hoverClass).length){c.onIdle.call(d(this));if(c.$path.length){b.proxy(l,c.$path)()}}},d=function(c){return c.closest("."+p.menuClass)},o=function(c){return d(c).data("sf-options")};return{hide:function(s){if(this.length){var v=this,w=o(v);if(!w){return this}var t=(w.retainPath===true)?w.$path:"",c=v.find("li."+w.hoverClass).add(this).not(t).removeClass(w.hoverClass).children(w.popUpSelector),u=w.speedOut;if(s){c.show();u=0}w.retainPath=false;w.onBeforeHide.call(c);c.stop(true,true).animate(w.animationOut,u,function(){var x=b(this);w.onHide.call(x)})}return this},show:function(){var t=o(this);if(!t){return this}var s=this.addClass(t.hoverClass),c=s.children(t.popUpSelector);t.onBeforeShow.call(c);c.stop(true,true).animate(t.animation,t.speed,function(){t.onShow.call(c)});return this},destroy:function(){return this.each(function(){var s=b(this),t=s.data("sf-options"),c;if(!t){return false}c=s.find(t.popUpSelector).parent("li");clearTimeout(t.sfTimer);m(s,t);n(c);f(s);s.off(".superfish").off(".hoverIntent");c.children(t.popUpSelector).attr("style",function(u,v){return v.replace(/display[^;]+;?/g,"")});t.$path.removeClass(t.hoverClass+" "+p.bcClass).addClass(t.pathClass);s.find("."+t.hoverClass).removeClass(t.hoverClass);t.onDestroy.call(s);s.removeData("sf-options")})},init:function(c){return this.each(function(){var t=b(this);if(t.data("sf-options")){return false}var u=b.extend({},b.fn.superfish.defaults,c),s=t.find(u.popUpSelector).parent("li");u.$path=r(t,u);t.data("sf-options",u);m(t,u);n(s);f(t);j(t,u);s.not("."+p.bcClass).superfish("hide",true);u.onInit.call(this)})}}})();b.fn.superfish=function(d,c){if(a[d]){return a[d].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof d==="object"||!d){return a.init.apply(this,arguments)}else{return b.error("Method "+d+" does not exist on jQuery.fn.superfish")}}};b.fn.superfish.defaults={popUpSelector:"ul",hoverClass:"sfHover",pathClass:"overrideThisToUse",pathLevels:1,delay:800,animation:{opacity:"show"},animationOut:{opacity:"hide"},speed:"normal",speedOut:"fast",cssArrows:true,disableHI:false,onInit:b.noop,onBeforeShow:b.noop,onShow:b.noop,onBeforeHide:b.noop,onHide:b.noop,onIdle:b.noop,onDestroy:b.noop}})(jQuery);(function($){$.fn.markItUp=function(settings,extraSettings){var method,params,options,ctrlKey,shiftKey,altKey;ctrlKey=shiftKey=altKey=false;if(typeof settings=="string"){method=settings;params=extraSettings}options={id:"",nameSpace:"",root:"",previewHandler:false,previewInWindow:"",previewInElement:"",previewAutoRefresh:true,previewPosition:"after",previewTemplatePath:"~/templates/preview.html",previewParser:false,previewParserPath:"",previewParserVar:"data",resizeHandle:true,beforeInsert:"",afterInsert:"",onEnter:{},onShiftEnter:{},onCtrlEnter:{},onTab:{},markupSet:[{}]};$.extend(options,settings,extraSettings);if(!options.root){$("script").each(function(a,tag){miuScript=$(tag).get(0).src.match(/(.*)jquery\.markitup(\.pack)?\.js$/);if(miuScript!==null){options.root=miuScript[1]}})}var uaMatch=function(ua){ua=ua.toLowerCase();var match=/(chrome)[ \/]([\w.]+)/.exec(ua)||/(webkit)[ \/]([\w.]+)/.exec(ua)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(ua)||/(msie) ([\w.]+)/.exec(ua)||ua.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(ua)||[];return{browser:match[1]||"",version:match[2]||"0"}};var matched=uaMatch(navigator.userAgent);var browser={};if(matched.browser){browser[matched.browser]=true;browser.version=matched.version}if(browser.chrome){browser.webkit=true}else{if(browser.webkit){browser.safari=true}}return this.each(function(){var $$,textarea,levels,scrollPosition,caretPosition,caretOffset,clicked,hash,header,footer,previewWindow,template,iFrame,abort;$$=$(this);textarea=this;levels=[];abort=false;scrollPosition=caretPosition=0;caretOffset=-1;options.previewParserPath=localize(options.previewParserPath);options.previewTemplatePath=localize(options.previewTemplatePath);if(method){switch(method){case"remove":remove();break;case"insert":markup(params);break;default:$.error("Method "+method+" does not exist on jQuery.markItUp")}return}function localize(data,inText){if(inText){return data.replace(/("|')~\//g,"$1"+options.root)}return data.replace(/^~\//,options.root)}function init(){id="";nameSpace="";if(options.id){id='id="'+options.id+'"'}else{if($$.attr("id")){id='id="markItUp'+($$.attr("id").substr(0,1).toUpperCase())+($$.attr("id").substr(1))+'"'}}if(options.nameSpace){nameSpace='class="'+options.nameSpace+'"'}$$.wrap("<div "+nameSpace+"></div>");$$.wrap("<div "+id+' class="markItUp"></div>');$$.wrap('<div class="markItUpContainer"></div>');$$.addClass("markItUpEditor");header=$('<div class="markItUpHeader"></div>').insertBefore($$);$(dropMenus(options.markupSet)).appendTo(header);footer=$('<div class="markItUpFooter"></div>').insertAfter($$);if(options.resizeHandle===true&&browser.safari!==true){resizeHandle=$('<div class="markItUpResizeHandle"></div>').insertAfter($$).bind("mousedown.markItUp",function(e){var h=$$.height(),y=e.clientY,mouseMove,mouseUp;mouseMove=function(e){$$.css("height",Math.max(20,e.clientY+h-y)+"px");return false};mouseUp=function(e){$("html").unbind("mousemove.markItUp",mouseMove).unbind("mouseup.markItUp",mouseUp);return false};$("html").bind("mousemove.markItUp",mouseMove).bind("mouseup.markItUp",mouseUp)});footer.append(resizeHandle)}$$.bind("keydown.markItUp",keyPressed).bind("keyup",keyPressed);$$.bind("insertion.markItUp",function(e,settings){if(settings.target!==false){get()}if(textarea===$.markItUp.focused){markup(settings)}});$$.bind("focus.markItUp",function(){$.markItUp.focused=this});if(options.previewInElement){refreshPreview()}}function stripHTML(html){var tmp=document.createElement("DIV");tmp.innerHTML=html;return tmp.textContent||tmp.innerText}function dropMenus(markupSet){var ul=$("<ul></ul>"),i=0;$("li:hover > ul",ul).css("display","block");$.each(markupSet,function(){var button=this,t="",title,li,j;title=(button.key)?(stripHTML(button.name)||"")+" [Ctrl+"+button.key+"]":(stripHTML(button.name)||"");key=(button.key)?'accesskey="'+button.key+'"':"";if(button.separator){li=$('<li class="markItUpSeparator">'+(button.separator||"")+"</li>").appendTo(ul)}else{i++;for(j=levels.length-1;j>=0;j--){t+=levels[j]+"-"}li=$('<li class="markItUpButton markItUpButton'+t+(i)+" "+(button.className||"")+'"><a href="" '+key+' title="'+title+'">'+(button.name||"")+"</a></li>").bind("contextmenu.markItUp",function(){return false}).bind("click.markItUp",function(e){e.preventDefault()}).bind("focusin.markItUp",function(){$$.focus()}).bind("mouseup",function(){if(button.call){eval(button.call)()}setTimeout(function(){markup(button)},1);return false}).bind("mouseenter.markItUp",function(){$("> ul",this).show();$(document).one("click",function(){$("ul ul",header).hide()})}).bind("mouseleave.markItUp",function(){$("> ul",this).hide()}).appendTo(ul);if(button.dropMenu){levels.push(i);$(li).addClass("markItUpDropMenu").append(dropMenus(button.dropMenu))}}});levels.pop();return ul}function magicMarkups(string){if(string){string=string.toString();string=string.replace(/\(\!\(([\s\S]*?)\)\!\)/g,function(x,a){var b=a.split("|!|");if(altKey===true){return(b[1]!==undefined)?b[1]:b[0]}else{return(b[1]===undefined)?"":b[0]}});string=string.replace(/\[\!\[([\s\S]*?)\]\!\]/g,function(x,a){var b=a.split(":!:");if(abort===true){return false}value=prompt(b[0],(b[1])?b[1]:"");if(value===null){abort=true}return value});return string}return""}function prepare(action){if($.isFunction(action)){action=action(hash)}return magicMarkups(action)}function build(string){var openWith=prepare(clicked.openWith);var placeHolder=prepare(clicked.placeHolder);var replaceWith=prepare(clicked.replaceWith);var closeWith=prepare(clicked.closeWith);var openBlockWith=prepare(clicked.openBlockWith);var closeBlockWith=prepare(clicked.closeBlockWith);var multiline=clicked.multiline;if(replaceWith!==""){block=openWith+replaceWith+closeWith}else{if(selection===""&&placeHolder!==""){block=openWith+placeHolder+closeWith}else{string=string||selection;var lines=[string],blocks=[];if(multiline===true){lines=string.split(/\r?\n/)}for(var l=0;l<lines.length;l++){line=lines[l];var trailingSpaces;if(trailingSpaces=line.match(/ *$/)){blocks.push(openWith+line.replace(/ *$/g,"")+closeWith+trailingSpaces)}else{blocks.push(openWith+line+closeWith)}}block=blocks.join("\n")}}block=openBlockWith+block+closeBlockWith;return{block:block,openBlockWith:openBlockWith,openWith:openWith,replaceWith:replaceWith,placeHolder:placeHolder,closeWith:closeWith,closeBlockWith:closeBlockWith}}function markup(button){var len,j,n,i;hash=clicked=button;get();$.extend(hash,{line:"",root:options.root,textarea:textarea,selection:(selection||""),caretPosition:caretPosition,ctrlKey:ctrlKey,shiftKey:shiftKey,altKey:altKey});prepare(options.beforeInsert);prepare(clicked.beforeInsert);if((ctrlKey===true&&shiftKey===true)||button.multiline===true){prepare(clicked.beforeMultiInsert)}$.extend(hash,{line:1});if((ctrlKey===true&&shiftKey===true)){lines=selection.split(/\r?\n/);for(j=0,n=lines.length,i=0;i<n;i++){if($.trim(lines[i])!==""){$.extend(hash,{line:++j,selection:lines[i]});lines[i]=build(lines[i]).block}else{lines[i]=""}}string={block:lines.join("\n")};start=caretPosition;len=string.block.length+((browser.opera)?n-1:0)}else{if(ctrlKey===true){string=build(selection);start=caretPosition+string.openWith.length;len=string.block.length-string.openWith.length-string.closeWith.length;len=len-(string.block.match(/ $/)?1:0);len-=fixIeBug(string.block)}else{if(shiftKey===true){string=build(selection);start=caretPosition;len=string.block.length;len-=fixIeBug(string.block)}else{string=build(selection);start=caretPosition+string.block.length;len=0;start-=fixIeBug(string.block)}}}if((selection===""&&string.replaceWith==="")){caretOffset+=fixOperaBug(string.block);start=caretPosition+string.openBlockWith.length+string.openWith.length;len=string.block.length-string.openBlockWith.length-string.openWith.length-string.closeWith.length-string.closeBlockWith.length;caretOffset=$$.val().substring(caretPosition,$$.val().length).length;caretOffset-=fixOperaBug($$.val().substring(0,caretPosition))}$.extend(hash,{caretPosition:caretPosition,scrollPosition:scrollPosition});if(string.block!==selection&&abort===false){insert(string.block);set(start,len)}else{caretOffset=-1}get();$.extend(hash,{line:"",selection:selection});if((ctrlKey===true&&shiftKey===true)||button.multiline===true){prepare(clicked.afterMultiInsert)}prepare(clicked.afterInsert);prepare(options.afterInsert);if(previewWindow&&options.previewAutoRefresh){refreshPreview()}shiftKey=altKey=ctrlKey=abort=false}function fixOperaBug(string){if(browser.opera){return string.length-string.replace(/\n*/g,"").length}return 0}function fixIeBug(string){if(browser.msie){return string.length-string.replace(/\r*/g,"").length}return 0}function insert(block){if(document.selection){var newSelection=document.selection.createRange();newSelection.text=block}else{textarea.value=textarea.value.substring(0,caretPosition)+block+textarea.value.substring(caretPosition+selection.length,textarea.value.length)}}function set(start,len){if(textarea.createTextRange){if(browser.opera&&browser.version>=9.5&&len==0){return false}range=textarea.createTextRange();range.collapse(true);range.moveStart("character",start);range.moveEnd("character",len);range.select()}else{if(textarea.setSelectionRange){textarea.setSelectionRange(start,start+len)}}textarea.scrollTop=scrollPosition;textarea.focus()}function get(){textarea.focus();scrollPosition=textarea.scrollTop;if(document.selection){selection=document.selection.createRange().text;if(browser.msie){var range=document.selection.createRange(),rangeCopy=range.duplicate();rangeCopy.moveToElementText(textarea);caretPosition=-1;while(rangeCopy.inRange(range)){rangeCopy.moveStart("character");caretPosition++}}else{caretPosition=textarea.selectionStart}}else{caretPosition=textarea.selectionStart;selection=textarea.value.substring(caretPosition,textarea.selectionEnd)}return selection}function preview(){return;if(typeof options.previewHandler==="function"){previewWindow=true}else{if(options.previewInElement){previewWindow=$(options.previewInElement)}else{if(!previewWindow||previewWindow.closed){if(options.previewInWindow){previewWindow=window.open("","preview",options.previewInWindow);$(window).unload(function(){previewWindow.close()})}else{iFrame=$('<iframe class="markItUpPreviewFrame"></iframe>');if(options.previewPosition=="after"){iFrame.insertAfter(footer)}else{iFrame.insertBefore(header)}previewWindow=iFrame[iFrame.length-1].contentWindow||frame[iFrame.length-1]}}else{if(altKey===true){if(iFrame){iFrame.remove()}else{previewWindow.close()}previewWindow=iFrame=false}}}}if(!options.previewAutoRefresh){refreshPreview()}if(options.previewInWindow){previewWindow.focus()}}function refreshPreview(){renderPreview()}function renderPreview(){var phtml;if(options.previewHandler&&typeof options.previewHandler==="function"){options.previewHandler($$.val())}else{if(options.previewParser&&typeof options.previewParser==="function"){var data=options.previewParser($$.val());writeInPreview(localize(data,1))}else{if(options.previewParserPath!==""){$.ajax({type:"POST",dataType:"text",global:false,url:options.previewParserPath,data:options.previewParserVar+"="+encodeURIComponent($$.val()),success:function(data){writeInPreview(localize(data,1))}})}else{if(!template){$.ajax({url:options.previewTemplatePath,dataType:"text",global:false,success:function(data){writeInPreview(localize(data,1).replace(/<!-- content -->/g,$$.val()))}})}}}}return false}function writeInPreview(data){if(options.previewInElement){$(options.previewInElement).html(data)}else{if(previewWindow&&previewWindow.document){try{sp=previewWindow.document.documentElement.scrollTop}catch(e){sp=0}previewWindow.document.open();previewWindow.document.write(data);previewWindow.document.close();previewWindow.document.documentElement.scrollTop=sp}}}function keyPressed(e){shiftKey=e.shiftKey;altKey=e.altKey;ctrlKey=(!(e.altKey&&e.ctrlKey))?(e.ctrlKey||e.metaKey):false;if(e.type==="keydown"){if(ctrlKey===true){li=$('a[accesskey="'+((e.keyCode==13)?"\\n":String.fromCharCode(e.keyCode))+'"]',header).parent("li");if(li.length!==0){ctrlKey=false;setTimeout(function(){li.triggerHandler("mouseup")},1);return false}}if(e.keyCode===13||e.keyCode===10){if(ctrlKey===true){ctrlKey=false;markup(options.onCtrlEnter);return options.onCtrlEnter.keepDefault}else{if(shiftKey===true){shiftKey=false;markup(options.onShiftEnter);return options.onShiftEnter.keepDefault}else{markup(options.onEnter);return options.onEnter.keepDefault}}}if(e.keyCode===9){if(shiftKey==true||ctrlKey==true||altKey==true){return false}if(caretOffset!==-1){get();caretOffset=$$.val().length-caretOffset;set(caretOffset,0);caretOffset=-1;return false}else{markup(options.onTab);return options.onTab.keepDefault}}}}function remove(){$$.unbind(".markItUp").removeClass("markItUpEditor");$$.parent("div").parent("div.markItUp").parent("div").replaceWith($$);$$.data("markItUp",null)}init()})};$.fn.markItUpRemove=function(){return this.each(function(){$(this).markItUp("remove")})};$.markItUp=function(settings){var options={target:false};$.extend(options,settings);if(options.target){return $(options.target).each(function(){$(this).focus();$(this).trigger("insertion",[options])})}else{$("textarea").trigger("insertion",[options])}}})(jQuery);var myBBCodeSettings={markupSet:[{name:"Bold",key:"B",openWith:"[b]",closeWith:"[/b]"},{name:"Italic",key:"I",openWith:"[i]",closeWith:"[/i]"},{name:"Underline",key:"U",openWith:"[u]",closeWith:"[/u]"},{name:"Strikethrough",openWith:"[s]",closeWith:"[/s]"},{name:"Font Size",openWith:"[size=[![Font size]!]]",closeWith:"[/size]",dropMenu:[{name:'<span style="line-height:16px;font-size:120%">Big</span>',openWith:"[size=120%]",closeWith:"[/size]"},{name:'<span style="line-height:16px;font-size:100%">Normal</span>',openWith:"[size=100%]",closeWith:"[/size]"},{name:'<span style="line-height:16px;font-size:80%">Small</span>',openWith:"[size=80%]",closeWith:"[/size]"}]},{name:"Font Color",className:"colors",openWith:"[color=[![Font Color]!]]",closeWith:"[/color]",dropMenu:[{name:"Yellow",openWith:"[color=yellow]",closeWith:"[/color]",className:"col1-1"},{name:"Orange",openWith:"[color=orange]",closeWith:"[/color]",className:"col1-2"},{name:"Red",openWith:"[color=red]",closeWith:"[/color]",className:"col1-3"},{name:"Blue",openWith:"[color=blue]",closeWith:"[/color]",className:"col2-1"},{name:"Purple",openWith:"[color=purple]",closeWith:"[/color]",className:"col2-2"},{name:"Green",openWith:"[color=green]",closeWith:"[/color]",className:"col2-3"},{name:"White",openWith:"[color=white]",closeWith:"[/color]",className:"col3-1"},{name:"Gray",openWith:"[color=gray]",closeWith:"[/color]",className:"col3-2"},{name:"Black",openWith:"[color=black]",closeWith:"[/color]",className:"col3-3"}]},{name:"Font Background Color",className:"bgcolors",openWith:"[bgcolor=[![Font Background Color]!]]",closeWith:"[/bgcolor]",dropMenu:[{name:"Yellow",openWith:"[bgcolor=yellow]",closeWith:"[/bgcolor]",className:"col1-1"},{name:"Orange",openWith:"[bgcolor=orange]",closeWith:"[/bgcolor]",className:"col1-2"},{name:"Red",openWith:"[bgcolor=red]",closeWith:"[/bgcolor]",className:"col1-3"},{name:"Blue",openWith:"[bgcolor=blue]",closeWith:"[/bgcolor]",className:"col2-1"},{name:"Purple",openWith:"[bgcolor=purple]",closeWith:"[/bgcolor]",className:"col2-2"},{name:"Green",openWith:"[bgcolor=green]",closeWith:"[/bgcolor]",className:"col2-3"},{name:"White",openWith:"[bgcolor=white]",closeWith:"[/bgcolor]",className:"col3-1"},{name:"Gray",openWith:"[bgcolor=gray]",closeWith:"[/bgcolor]",className:"col3-2"},{name:"Black",openWith:"[bgcolor=black]",closeWith:"[/bgcolor]",className:"col3-3"}]},{separator:" "},{name:"Picture",key:"P",replaceWith:"[img][![Image url]!][/img]"},{name:"Link",key:"L",openWith:"[url=[![Link url]!]]",closeWith:"[/url]",placeHolder:"Your text to link here..."},{name:"YouTube Video",openWith:"[youtube]",closeWith:"[/youtube]"},{separator:" "},{name:"Bulleted list",openWith:"[list]\n",closeWith:"\n[/list]"},{name:"Numeric list",openWith:"[list=[![Starting number]!]]\n",closeWith:"\n[/list]"},{name:"List item",openWith:"[*] "},{separator:" "},{name:"Quotes",openWith:"[quote]",closeWith:"[/quote]"},{name:"Code",openWith:"[code]",closeWith:"[/code]"},{separator:" "},{name:"Clean",replaceWith:function(a){return a.selection.replace(/\[(.*?)\]/g,"")}},]};(function(b){var a=0;b.fn.upload=function(f,j,m){var k=this,e,l="jquery_upload"+ ++a,g=b('<iframe name="'+l+'" style="position:absolute;top:-9999px" />').appendTo("body"),h='<form target="'+l+'" method="post" action="'+f+'" enctype="multipart/form-data" accept-charset="UTF-8"></form>';if(b.isFunction(j)){m=j;j={}}h=k.wrap(h).parent("form");e=d(j);e=e?b(e).appendTo(h):null;h.submit(function(){g.on("load",function(){var n;try{n=b.parseJSON(g.contents().text())}catch(o){alert("上传文件失败，请换用其他浏览器上传文件。错误信息:"+o.message);submitBug({msg:o.message,data:g.contents().text()})}if(e){e.remove()}k.unwrap();g.remove();if(m){m.call(self,n)}})}).submit()};function d(e){return b.map(c(e),function(f){return'<input type="hidden" name="'+f.name+'" value="'+f.value+'"/>'}).join("")}function c(e){if(b.isArray(e)){return e}var g=[];function f(h,j){g.push({name:h,value:j})}if(typeof e==="object"){b.each(e,function(h){if(b.isArray(this)){b.each(this,function(){f(h,this)})}else{f(h,b.isFunction(this)?this():this)}})}else{if(typeof e==="string"){b.each(e.split("&"),function(){var h=b.map(this.split("="),function(j){return decodeURIComponent(j.replace(/\+/g," "))});f(h[0],h[1])})}}return g}})(jQuery);function submitBug(a){$.post("/api/bug?action=post",a)}var session={set:function(a,b){if(b==null){sessionStorage.removeItem(a)}else{sessionStorage.setItem(a,JSON.stringify(b))}},get:function(a){var b=sessionStorage.getItem(a);if(b==null){return null}else{return JSON.parse(b)}},remove:function(a){sessionStorage.removeItem(a)},clear:function(){sessionStorage.clear()}};var cache={set:function(a,b){if(b==null){localStorage.removeItem(a)}else{localStorage.setItem(a,JSON.stringify(b))}},get:function(a){var b=localStorage.getItem(a);if(b==null){return null}else{return JSON.parse(b)}},remove:function(a){localStorage.removeItem(a)},clear:function(){localStorage.clear()}};$(document).ready(function(){var a=function(d){if(d.sessionID){cache.set("sessionID",d.sessionID);cache.set("uid",d.uid);if(d.uid>0){cache.set("username",d.username);cache.set("role",d.role)}if(d.pm>0){session.set("pm",d.pm)}return d.uid}else{if(d.error){alert(d.error)}else{alert("对话加载失败")}return 0}};var b=function(j){$(".image_slider").imageSlider();$(".ajax_load").each(function(){var y=$(this);var z=y.attr("data-ajax");if(z){$.getJSON(z,function(A){for(var B in A){$(".ajax_"+B,y).html(A[B])}})}});$("nav#page_navbar ul.sf-menu").superfish();var w=false,r=$("div.nav_mobile > a.icon-menu"),s=$("nav#page_navbar");var t=function(){if(s.css("display")==="none"){if(!w){r.on("click",function(y){y.preventDefault();s.toggleClass("hidden")});w=true}}else{if(w){r.off("click");w=false}if(!s.hasClass("hidden")){s.addClass("hidden")}}};t();$(window).resize(t);$("div.nav_mobile a.icon-left-big").click(function(y){y.preventDefault();window.history.back()});$("div.nav_mobile a.icon-right-big").click(function(y){y.preventDefault();window.history.forward()});$("div.nav_mobile a.icon-cw").click(function(y){y.preventDefault();location.reload()});var x=function(y){var z=new Array();$("th",y).each(function(){z.push(this.innerHTML)});if(z.length>0){$("tbody tr",y).each(function(){var A=$("td",this);for(i=0;i<A.length;i++){$(A.get(i)).attr("data-header",z[i])}})}};$("table").each(function(){x(this)});var n=function(){$(".v_guest").show();$('[class*="v_user"]').remove()};var e=function(){$(".v_guest").remove();$(".v_user").show();$('[class*="v_user_"]').hide();$(".v_user_"+j).show();var A=cache.get("role");if(A&&A instanceof Array){for(var C=0;C<A.length;++C){$(".v_user_"+A[C]).show()}}var B=cache.get("username");if(B){$("#username").text(B)}$.get("/api/message/new",function(I){if(I.count&&I.count>0){$("a#pm").append('<span style="color:red;"> ('+I.count+")<span>")}});var D=$("#bbcode_editor");if(D.length){var G=$("#bbcode_editor textarea"),H=$("#bbcode_editor .node_title"),F=$("#file_list"),E=$("tbody",F);G.markItUp(myBBCodeSettings);$("button.delete").click(function(J){var I=confirm("此操作不可恢复，您确认要删除该内容吗？");if(I){window.location=$(this).attr("data-action")}});$("button.reply").click(function(I){D.attr("action",$(this).attr("data-action"));H.hide();F.hide();E.children().remove();G.val("").focus();window.scrollTo(0,D.offset().top)});$("button.quote").click(function(K){D.attr("action",$(this).attr("data-action"));H.hide();F.hide();E.children().remove();var J=$($(this).attr("data-raw"));var I=J.find("pre.username").html(),L='[quote="'+I+'"]'+J.find("pre.body").html()+"[/quote]\n";G.val("").focus();$.markItUp({replaceWith:L});window.scrollTo(0,D.offset().top)});var z=function(M){for(var K=0;K<M.length;K++){var O=M[K].fid?M[K].fid:M[K].path,L=new Array("jpeg","gif","png"),J=M[K].path.split(".").pop(),I;if(L.indexOf(J)>=0){I="[img]"+M[K].path+"[/img]"}else{I='[file="'+M[K].path+'"]'+M[K].name+"[/file]"}var N='<tr><td><input type="text" name="files['+O+'][name]" value="'+M[K].name+'"><input type="hidden" name="files['+O+'][path]" value="'+M[K].path+'"></td><td>'+I+'</td><td><button type="button" class="file_delete">删除</button></td></tr>';E.append(N)}x(F)};$("button.edit").click(function(L){var K=$(this).attr("data-action");D.attr("action",K);if(K.split("/")[1]=="node"){H.show()}else{H.hide()}E.children().remove();var J=$($(this).attr("data-raw"));var I=$.parseJSON(J.find("pre.files").html());if(I instanceof Array&&I.length>0){z(I);F.show()}else{F.hide()}G.val($($(this).attr("data-raw")).find("pre.body").html()).focus();window.scrollTo(0,D.offset().top)});$("button.create_node").click(function(I){D.attr("action",$(this).attr("data-action"));H.show();F.hide();E.children().remove();G.val("");$("input",H).val("").focus();window.scrollTo(0,D.offset().top)});$("#file_upload").click(function(M){var K=$("#file_select");if(K.val().length>0){var I=0,L=K.get(0).files;if(L){if(L.length>5){alert("一次只能上传 5 张图片");return}for(C=0;C<L.length;C++){I+=L[C].size;if(I>5242880){alert("一次只能上传图片的总大小为 5 MB，您只能选择前 "+C+" 张图片上传");return}}}var J=$(this);J.prepend('<span class="spinner"></span>');J.prop("disabled",true);K.upload("/api/file?action=post",function(O){K.val("");J.prop("disabled",false);J.find("span.spinner").remove();if(O){try{if(O.error&&O.error.length>0){var Q="";if(Object.prototype.toString.call(O.error)==="[object Array]"){for(var N=0;N<O.error.length;N++){Q=Q+O.error[N].name+" : "+O.error[N].error+"\n"}}else{Q=O.error}alert(Q)}if(O.saved&&O.saved.length>0){z(O.saved);F.show()}}catch(P){alert("上传文件失败，请换用其他浏览器上传文件。错误信息:"+P.message);submitBug({msg:P.message,data:O})}}})}});$("#file_clear").click(function(){$("#file_select").val("")});F.on("click",".file_delete",function(J){var K=this.parentNode.parentNode;var I=K.parentNode.parentNode;I.deleteRow(K.rowIndex);if(I.rows.length<=1){F.hide()}});$("#bbcode_editor button:submit").click(function(I){if($("#file_select").val()){alert("请先上传或清空选中的文件");I.preventDefault()}});$("button.bookmark").click(function(){var I=$(this);$.get(I.attr("data-action"),function(){alert("帖子成功加入到您的收藏夹中！")})})}var y=[];$("button.edit_bookmark").click(function(){var I=$(this);if(I.text()=="编辑"){I.text("保存");$("button.delete_bookmark").show()}else{if(y){I.prop("disabled",true);$.get("/api/bookmark/"+y.join()+"?action=delete",function(){I.text("编辑");$("button.delete_bookmark").hide();y=[];I.prop("disabled",false)})}else{I.text("编辑");$("button.delete_bookmark").hide()}}});$("button.delete_bookmark").click(function(){button=$(this);y.push(button.attr("data-nid"));button.parent().remove()})};var o=$(window),h=$("#goTop"),k=false;var l=function(){k=true;h.stop().animate({bottom:"20px"},300)};var p=function(){k=false;h.stop().animate({bottom:"-100px"},300)};var f=function(){if(o.scrollTop()>300){if(!k){l()}}else{if(k){p()}}};f();o.scroll(f);h.click(function(y){$("html, body").stop().animate({scrollTop:0},300,p);y.preventDefault()});var v={"#/user/login":'<form accept-charset="UTF-8" autocomplete="on" method="post" action="/user/login"><fieldset><label class="label" data-help="输入您在 缤纷休斯顿 华人论坛 的用户名">用户名</label><input name="username" type="text" required autofocus></fieldset><fieldset><label class="label" data-help="输入与您用户名相匹配的密码">密码</label><input name="password" type="password" required></fieldset><fieldset><button type="submit">登录</button></fieldset></form>',"#/password/forget":'<form accept-charset="UTF-8" autocomplete="on" method="post" action="/password/forget"><fieldset><label class="label" data-help="输入您的用户名">用户名</label><input name="username" type="text" required autofocus></fieldset><fieldset><label class="label" data-help="输入您注册时使用的电子邮箱地址">注册邮箱</label><input name="email" type="email" required></fieldset><fieldset><button type="submit">发送重设密码链接</button></fieldset></form>',"#/user/username":'<form accept-charset="UTF-8" method="post" action="/user/username"><fieldset><label class="label" data-help="输入您注册时使用的电子邮箱地址">注册邮箱</label><input size="22" name="email" type="email" required autofocus></fieldset><fieldset><button type="submit">发送您的用户名</button></fieldset></form>',"#/user/register":'<form accept-charset="UTF-8" method="post" action="/user/register"><fieldset><label class="label" data-help="允许空格，不允许&quot;.&quot;、“-”、“_”以外的其他符号">用户名</label><input name="username" type="text" required autofocus></fieldset><fieldset><label class="label" data-help="一个有效的电子邮件地址。帐号激活后的初始密码和所有本站发出的信件都将寄至此地址。电子邮件地址将不会被公开，仅当您想要接收新密码或通知时才会使用">电子邮箱</label><input name="email" type="email" required></fieldset><fieldset><label class="label" data-help="确认电子邮箱">确认邮箱</label><input name="email2" type="email" required></fieldset><fieldset><label class="label">右边图片的内容是什么？</label><input name="captcha" type="text" required><img id="captchaImage" alt="图形验证未能正确显示，请刷新" src="/api/captcha/'+Math.random().toString().slice(2)+'"><a onclick=\'document.getElementById("captchaImage").setAttribute("src", "/api/captcha/" + Math.random().toString().slice(2)); event.preventDefault();\' href="#">看不清，换一张</a></fieldset><fieldset>[<a href="/node/23200">网站使用规范</a>] [<a href="/term">免责声明</a>]</fieldset><fieldset><button type="submit">同意使用规范和免责声明，并创建新帐号</button></fieldset></form>',"#/password/change":'<form accept-charset="UTF-8" autocomplete="off" method="post" action="/password/change"><fieldset><label class="label oldpassword">旧密码</label><input name="password_old" type="password" required autofocus></fieldset><fieldset><label class="label">新密码</label><input name="password_new" type="password" required></fieldset><fieldset><label class="label">确认新密码</label><input name="password_new2" type="password" required></fieldset><fieldset><button type="submit">更改密码</button></fieldset></form>',"#/pm/send":'<form accept-charset="UTF-8" autocomplete="off" method="post" action="/pm/send/[uid]"><fieldset><label class="label">收信人</label><a href="/user/[uid]">[username]</a></fieldset><fieldset><label class="label">短信正文</label><textarea name="body" required autofocus></textarea></fieldset><fieldset><button type="submit">发送短信</button></fieldset></form>'};var g=$("div#popupbox"),d=$("div#messagebox"),u=$('<div id="overlay"></div>'),q=false;u.click(function(){u.detach();g.hide();q=false});var m=function(){g.css("left",o.scrollLeft()+Math.max((o.width()-g.outerWidth())/2,0));g.css("top",o.scrollTop()+Math.max((o.height()-g.outerHeight())/2,0))};$("a.popup").click(function(D){D.preventDefault();var B=$(this);var A=B.attr("href");var y=v[A];if(y){if(!jQuery.contains(document,u[0])){u.insertBefore(g)}if(B.attr("data-vars")){var C=JSON.parse(B.attr("data-vars"));for(var z in C){y=y.replace(new RegExp("\\["+z+"\\]","g"),String(C[z]))}}g.html(y).show(0,m);q=true;$(window).resize(function(){if(q){m()}});var E=$("form",g);E.submit(function(F){F.preventDefault();if(E.attr("action")){$.ajax({type:"POST",url:E.attr("action"),data:E.serialize(),success:function(G){g.html(G)},error:function(){alert("错误：提交数据错误")}})}else{alert("错误：无法提交数据")}})}});if(j>0){e()}else{n()}};var c=$.cookie("LZXSID");if(c==null){b(0)}else{if(c!=cache.get("sessionID")){cache.clear();session.clear();$.get("/api/authentication/"+c,function(d){a(d);b(cache.get("uid"))})}else{b(cache.get("uid"))}}});