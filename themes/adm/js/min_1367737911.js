(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{a(jQuery)}}(function(e){var a=/\+/g;function d(g){return g}function b(g){return decodeURIComponent(g.replace(a," "))}function f(g){if(g.indexOf('"')===0){g=g.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\")}try{return c.json?JSON.parse(g):g}catch(h){}}var c=e.cookie=function(p,o,u){if(o!==undefined){u=e.extend({},c.defaults,u);if(typeof u.expires==="number"){var q=u.expires,s=u.expires=new Date();s.setDate(s.getDate()+q)}o=c.json?JSON.stringify(o):String(o);return(document.cookie=[c.raw?p:encodeURIComponent(p),"=",c.raw?o:encodeURIComponent(o),u.expires?"; expires="+u.expires.toUTCString():"",u.path?"; path="+u.path:"",u.domain?"; domain="+u.domain:"",u.secure?"; secure":""].join(""))}var g=c.raw?d:b;var r=document.cookie.split("; ");var v=p?undefined:{};for(var n=0,k=r.length;n<k;n++){var m=r[n].split("=");var h=g(m.shift());var j=g(m.join("="));if(p&&p===h){v=f(j);break}if(!p){v[h]=f(j)}}return v};c.defaults={};e.removeCookie=function(h,g){if(e.cookie(h)!==undefined){e.cookie(h,"",e.extend({},g,{expires:-1}));return true}return false}}));(function(c){var b=0;c.fn.upload=function(f,j,o,n){var m=this,l,k="jquery_upload"+ ++b,h=c('<iframe name="'+k+'" style="position:absolute;top:-9999px" />').appendTo("body"),g='<form target="'+k+'" method="post" action="'+f+'" enctype="multipart/form-data" />';if(c.isFunction(j)){n=o;o=j;j={}}g=m.wrap(g).parent("form");l=e(j);l=l?c(l).appendTo(g):null;g.submit(function(){h.on("load",function(){var p=a(this,n);if(l){l.remove()}m.unwrap();h.remove();if(n==="script"){c.globalEval(p)}if(o){o.call(self,p)}})}).submit()};function e(f){return c.map(d(f),function(g){return'<input type="hidden" name="'+g.name+'" value="'+g.value+'"/>'}).join("")}function d(f){if(c.isArray(f)){return f}var h=[];function g(j,k){h.push({name:j,value:k})}if(typeof f==="object"){c.each(f,function(j){if(c.isArray(this)){c.each(this,function(){g(j,this)})}else{g(j,c.isFunction(this)?this():this)}})}else{if(typeof f==="string"){c.each(f.split("&"),function(){var j=c.map(this.split("="),function(k){return decodeURIComponent(k.replace(/\+/g," "))});g(j[0],j[1])})}}return h}function a(g,f){var j;var h=c(g).contents()[0];if(c.isXMLDoc(h)){return h}j=c(h).find("body").html();switch(f){case"xml":j=c.parseXML(j);break;case"json":j=c.parseJSON(j);break}return j}})(jQuery);(function($){$.fn.markItUp=function(settings,extraSettings){var method,params,options,ctrlKey,shiftKey,altKey;ctrlKey=shiftKey=altKey=false;if(typeof settings=="string"){method=settings;params=extraSettings}options={id:"",nameSpace:"",root:"",previewHandler:false,previewInWindow:"",previewInElement:"",previewAutoRefresh:true,previewPosition:"after",previewTemplatePath:"~/templates/preview.html",previewParser:false,previewParserPath:"",previewParserVar:"data",resizeHandle:true,beforeInsert:"",afterInsert:"",onEnter:{},onShiftEnter:{},onCtrlEnter:{},onTab:{},markupSet:[{}]};$.extend(options,settings,extraSettings);if(!options.root){$("script").each(function(a,tag){miuScript=$(tag).get(0).src.match(/(.*)jquery\.markitup(\.pack)?\.js$/);if(miuScript!==null){options.root=miuScript[1]}})}var uaMatch=function(ua){ua=ua.toLowerCase();var match=/(chrome)[ \/]([\w.]+)/.exec(ua)||/(webkit)[ \/]([\w.]+)/.exec(ua)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(ua)||/(msie) ([\w.]+)/.exec(ua)||ua.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(ua)||[];return{browser:match[1]||"",version:match[2]||"0"}};var matched=uaMatch(navigator.userAgent);var browser={};if(matched.browser){browser[matched.browser]=true;browser.version=matched.version}if(browser.chrome){browser.webkit=true}else{if(browser.webkit){browser.safari=true}}return this.each(function(){var $$,textarea,levels,scrollPosition,caretPosition,caretOffset,clicked,hash,header,footer,previewWindow,template,iFrame,abort;$$=$(this);textarea=this;levels=[];abort=false;scrollPosition=caretPosition=0;caretOffset=-1;options.previewParserPath=localize(options.previewParserPath);options.previewTemplatePath=localize(options.previewTemplatePath);if(method){switch(method){case"remove":remove();break;case"insert":markup(params);break;default:$.error("Method "+method+" does not exist on jQuery.markItUp")}return}function localize(data,inText){if(inText){return data.replace(/("|')~\//g,"$1"+options.root)}return data.replace(/^~\//,options.root)}function init(){id="";nameSpace="";if(options.id){id='id="'+options.id+'"'}else{if($$.attr("id")){id='id="markItUp'+($$.attr("id").substr(0,1).toUpperCase())+($$.attr("id").substr(1))+'"'}}if(options.nameSpace){nameSpace='class="'+options.nameSpace+'"'}$$.wrap("<div "+nameSpace+"></div>");$$.wrap("<div "+id+' class="markItUp"></div>');$$.wrap('<div class="markItUpContainer"></div>');$$.addClass("markItUpEditor");header=$('<div class="markItUpHeader"></div>').insertBefore($$);$(dropMenus(options.markupSet)).appendTo(header);footer=$('<div class="markItUpFooter"></div>').insertAfter($$);if(options.resizeHandle===true&&browser.safari!==true){resizeHandle=$('<div class="markItUpResizeHandle"></div>').insertAfter($$).bind("mousedown.markItUp",function(e){var h=$$.height(),y=e.clientY,mouseMove,mouseUp;mouseMove=function(e){$$.css("height",Math.max(20,e.clientY+h-y)+"px");return false};mouseUp=function(e){$("html").unbind("mousemove.markItUp",mouseMove).unbind("mouseup.markItUp",mouseUp);return false};$("html").bind("mousemove.markItUp",mouseMove).bind("mouseup.markItUp",mouseUp)});footer.append(resizeHandle)}$$.bind("keydown.markItUp",keyPressed).bind("keyup",keyPressed);$$.bind("insertion.markItUp",function(e,settings){if(settings.target!==false){get()}if(textarea===$.markItUp.focused){markup(settings)}});$$.bind("focus.markItUp",function(){$.markItUp.focused=this});if(options.previewInElement){refreshPreview()}}function stripHTML(html){var tmp=document.createElement("DIV");tmp.innerHTML=html;return tmp.textContent||tmp.innerText}function dropMenus(markupSet){var ul=$("<ul></ul>"),i=0;$("li:hover > ul",ul).css("display","block");$.each(markupSet,function(){var button=this,t="",title,li,j;title=(button.key)?(stripHTML(button.name)||"")+" [Ctrl+"+button.key+"]":(stripHTML(button.name)||"");key=(button.key)?'accesskey="'+button.key+'"':"";if(button.separator){li=$('<li class="markItUpSeparator">'+(button.separator||"")+"</li>").appendTo(ul)}else{i++;for(j=levels.length-1;j>=0;j--){t+=levels[j]+"-"}li=$('<li class="markItUpButton markItUpButton'+t+(i)+" "+(button.className||"")+'"><a href="" '+key+' title="'+title+'">'+(button.name||"")+"</a></li>").bind("contextmenu.markItUp",function(){return false}).bind("click.markItUp",function(e){e.preventDefault()}).bind("focusin.markItUp",function(){$$.focus()}).bind("mouseup",function(){if(button.call){eval(button.call)()}setTimeout(function(){markup(button)},1);return false}).bind("mouseenter.markItUp",function(){$("> ul",this).show();$(document).one("click",function(){$("ul ul",header).hide()})}).bind("mouseleave.markItUp",function(){$("> ul",this).hide()}).appendTo(ul);if(button.dropMenu){levels.push(i);$(li).addClass("markItUpDropMenu").append(dropMenus(button.dropMenu))}}});levels.pop();return ul}function magicMarkups(string){if(string){string=string.toString();string=string.replace(/\(\!\(([\s\S]*?)\)\!\)/g,function(x,a){var b=a.split("|!|");if(altKey===true){return(b[1]!==undefined)?b[1]:b[0]}else{return(b[1]===undefined)?"":b[0]}});string=string.replace(/\[\!\[([\s\S]*?)\]\!\]/g,function(x,a){var b=a.split(":!:");if(abort===true){return false}value=prompt(b[0],(b[1])?b[1]:"");if(value===null){abort=true}return value});return string}return""}function prepare(action){if($.isFunction(action)){action=action(hash)}return magicMarkups(action)}function build(string){var openWith=prepare(clicked.openWith);var placeHolder=prepare(clicked.placeHolder);var replaceWith=prepare(clicked.replaceWith);var closeWith=prepare(clicked.closeWith);var openBlockWith=prepare(clicked.openBlockWith);var closeBlockWith=prepare(clicked.closeBlockWith);var multiline=clicked.multiline;if(replaceWith!==""){block=openWith+replaceWith+closeWith}else{if(selection===""&&placeHolder!==""){block=openWith+placeHolder+closeWith}else{string=string||selection;var lines=[string],blocks=[];if(multiline===true){lines=string.split(/\r?\n/)}for(var l=0;l<lines.length;l++){line=lines[l];var trailingSpaces;if(trailingSpaces=line.match(/ *$/)){blocks.push(openWith+line.replace(/ *$/g,"")+closeWith+trailingSpaces)}else{blocks.push(openWith+line+closeWith)}}block=blocks.join("\n")}}block=openBlockWith+block+closeBlockWith;return{block:block,openBlockWith:openBlockWith,openWith:openWith,replaceWith:replaceWith,placeHolder:placeHolder,closeWith:closeWith,closeBlockWith:closeBlockWith}}function markup(button){var len,j,n,i;hash=clicked=button;get();$.extend(hash,{line:"",root:options.root,textarea:textarea,selection:(selection||""),caretPosition:caretPosition,ctrlKey:ctrlKey,shiftKey:shiftKey,altKey:altKey});prepare(options.beforeInsert);prepare(clicked.beforeInsert);if((ctrlKey===true&&shiftKey===true)||button.multiline===true){prepare(clicked.beforeMultiInsert)}$.extend(hash,{line:1});if((ctrlKey===true&&shiftKey===true)){lines=selection.split(/\r?\n/);for(j=0,n=lines.length,i=0;i<n;i++){if($.trim(lines[i])!==""){$.extend(hash,{line:++j,selection:lines[i]});lines[i]=build(lines[i]).block}else{lines[i]=""}}string={block:lines.join("\n")};start=caretPosition;len=string.block.length+((browser.opera)?n-1:0)}else{if(ctrlKey===true){string=build(selection);start=caretPosition+string.openWith.length;len=string.block.length-string.openWith.length-string.closeWith.length;len=len-(string.block.match(/ $/)?1:0);len-=fixIeBug(string.block)}else{if(shiftKey===true){string=build(selection);start=caretPosition;len=string.block.length;len-=fixIeBug(string.block)}else{string=build(selection);start=caretPosition+string.block.length;len=0;start-=fixIeBug(string.block)}}}if((selection===""&&string.replaceWith==="")){caretOffset+=fixOperaBug(string.block);start=caretPosition+string.openBlockWith.length+string.openWith.length;len=string.block.length-string.openBlockWith.length-string.openWith.length-string.closeWith.length-string.closeBlockWith.length;caretOffset=$$.val().substring(caretPosition,$$.val().length).length;caretOffset-=fixOperaBug($$.val().substring(0,caretPosition))}$.extend(hash,{caretPosition:caretPosition,scrollPosition:scrollPosition});if(string.block!==selection&&abort===false){insert(string.block);set(start,len)}else{caretOffset=-1}get();$.extend(hash,{line:"",selection:selection});if((ctrlKey===true&&shiftKey===true)||button.multiline===true){prepare(clicked.afterMultiInsert)}prepare(clicked.afterInsert);prepare(options.afterInsert);if(previewWindow&&options.previewAutoRefresh){refreshPreview()}shiftKey=altKey=ctrlKey=abort=false}function fixOperaBug(string){if(browser.opera){return string.length-string.replace(/\n*/g,"").length}return 0}function fixIeBug(string){if(browser.msie){return string.length-string.replace(/\r*/g,"").length}return 0}function insert(block){if(document.selection){var newSelection=document.selection.createRange();newSelection.text=block}else{textarea.value=textarea.value.substring(0,caretPosition)+block+textarea.value.substring(caretPosition+selection.length,textarea.value.length)}}function set(start,len){if(textarea.createTextRange){if(browser.opera&&browser.version>=9.5&&len==0){return false}range=textarea.createTextRange();range.collapse(true);range.moveStart("character",start);range.moveEnd("character",len);range.select()}else{if(textarea.setSelectionRange){textarea.setSelectionRange(start,start+len)}}textarea.scrollTop=scrollPosition;textarea.focus()}function get(){textarea.focus();scrollPosition=textarea.scrollTop;if(document.selection){selection=document.selection.createRange().text;if(browser.msie){var range=document.selection.createRange(),rangeCopy=range.duplicate();rangeCopy.moveToElementText(textarea);caretPosition=-1;while(rangeCopy.inRange(range)){rangeCopy.moveStart("character");caretPosition++}}else{caretPosition=textarea.selectionStart}}else{caretPosition=textarea.selectionStart;selection=textarea.value.substring(caretPosition,textarea.selectionEnd)}return selection}function preview(){return;if(typeof options.previewHandler==="function"){previewWindow=true}else{if(options.previewInElement){previewWindow=$(options.previewInElement)}else{if(!previewWindow||previewWindow.closed){if(options.previewInWindow){previewWindow=window.open("","preview",options.previewInWindow);$(window).unload(function(){previewWindow.close()})}else{iFrame=$('<iframe class="markItUpPreviewFrame"></iframe>');if(options.previewPosition=="after"){iFrame.insertAfter(footer)}else{iFrame.insertBefore(header)}previewWindow=iFrame[iFrame.length-1].contentWindow||frame[iFrame.length-1]}}else{if(altKey===true){if(iFrame){iFrame.remove()}else{previewWindow.close()}previewWindow=iFrame=false}}}}if(!options.previewAutoRefresh){refreshPreview()}if(options.previewInWindow){previewWindow.focus()}}function refreshPreview(){renderPreview()}function renderPreview(){var phtml;if(options.previewHandler&&typeof options.previewHandler==="function"){options.previewHandler($$.val())}else{if(options.previewParser&&typeof options.previewParser==="function"){var data=options.previewParser($$.val());writeInPreview(localize(data,1))}else{if(options.previewParserPath!==""){$.ajax({type:"POST",dataType:"text",global:false,url:options.previewParserPath,data:options.previewParserVar+"="+encodeURIComponent($$.val()),success:function(data){writeInPreview(localize(data,1))}})}else{if(!template){$.ajax({url:options.previewTemplatePath,dataType:"text",global:false,success:function(data){writeInPreview(localize(data,1).replace(/<!-- content -->/g,$$.val()))}})}}}}return false}function writeInPreview(data){if(options.previewInElement){$(options.previewInElement).html(data)}else{if(previewWindow&&previewWindow.document){try{sp=previewWindow.document.documentElement.scrollTop}catch(e){sp=0}previewWindow.document.open();previewWindow.document.write(data);previewWindow.document.close();previewWindow.document.documentElement.scrollTop=sp}}}function keyPressed(e){shiftKey=e.shiftKey;altKey=e.altKey;ctrlKey=(!(e.altKey&&e.ctrlKey))?(e.ctrlKey||e.metaKey):false;if(e.type==="keydown"){if(ctrlKey===true){li=$('a[accesskey="'+((e.keyCode==13)?"\\n":String.fromCharCode(e.keyCode))+'"]',header).parent("li");if(li.length!==0){ctrlKey=false;setTimeout(function(){li.triggerHandler("mouseup")},1);return false}}if(e.keyCode===13||e.keyCode===10){if(ctrlKey===true){ctrlKey=false;markup(options.onCtrlEnter);return options.onCtrlEnter.keepDefault}else{if(shiftKey===true){shiftKey=false;markup(options.onShiftEnter);return options.onShiftEnter.keepDefault}else{markup(options.onEnter);return options.onEnter.keepDefault}}}if(e.keyCode===9){if(shiftKey==true||ctrlKey==true||altKey==true){return false}if(caretOffset!==-1){get();caretOffset=$$.val().length-caretOffset;set(caretOffset,0);caretOffset=-1;return false}else{markup(options.onTab);return options.onTab.keepDefault}}}}function remove(){$$.unbind(".markItUp").removeClass("markItUpEditor");$$.parent("div").parent("div.markItUp").parent("div").replaceWith($$);$$.data("markItUp",null)}init()})};$.fn.markItUpRemove=function(){return this.each(function(){$(this).markItUp("remove")})};$.markItUp=function(settings){var options={target:false};$.extend(options,settings);if(options.target){return $(options.target).each(function(){$(this).focus();$(this).trigger("insertion",[options])})}else{$("textarea").trigger("insertion",[options])}}})(jQuery);var mySettings={previewParserPath:"",markupSet:[{name:"Bold",key:"B",openWith:"[b]",closeWith:"[/b]"},{name:"Italic",key:"I",openWith:"[i]",closeWith:"[/i]"},{name:"Underline",key:"U",openWith:"[u]",closeWith:"[/u]"},{name:"Strikethrough",openWith:"[s]",closeWith:"[/s]"},{name:"Font Size",openWith:"[size=[![Font size]!]]",closeWith:"[/size]",dropMenu:[{name:'<span style="line-height:16px;font-size:120%">Big</span>',openWith:"[size=120%]",closeWith:"[/size]"},{name:'<span style="line-height:16px;font-size:100%">Normal</span>',openWith:"[size=100%]",closeWith:"[/size]"},{name:'<span style="line-height:16px;font-size:80%">Small</span>',openWith:"[size=80%]",closeWith:"[/size]"}]},{name:"Font Color",className:"colors",openWith:"[color=[![Font Color]!]]",closeWith:"[/color]",dropMenu:[{name:"Yellow",openWith:"[color=yellow]",closeWith:"[/color]",className:"col1-1"},{name:"Orange",openWith:"[color=orange]",closeWith:"[/color]",className:"col1-2"},{name:"Red",openWith:"[color=red]",closeWith:"[/color]",className:"col1-3"},{name:"Blue",openWith:"[color=blue]",closeWith:"[/color]",className:"col2-1"},{name:"Purple",openWith:"[color=purple]",closeWith:"[/color]",className:"col2-2"},{name:"Green",openWith:"[color=green]",closeWith:"[/color]",className:"col2-3"},{name:"White",openWith:"[color=white]",closeWith:"[/color]",className:"col3-1"},{name:"Gray",openWith:"[color=gray]",closeWith:"[/color]",className:"col3-2"},{name:"Black",openWith:"[color=black]",closeWith:"[/color]",className:"col3-3"}]},{name:"Font Background Color",className:"bgcolors",openWith:"[bgcolor=[![Font Background Color]!]]",closeWith:"[/bgcolor]",dropMenu:[{name:"Yellow",openWith:"[bgcolor=yellow]",closeWith:"[/bgcolor]",className:"col1-1"},{name:"Orange",openWith:"[bgcolor=orange]",closeWith:"[/bgcolor]",className:"col1-2"},{name:"Red",openWith:"[bgcolor=red]",closeWith:"[/bgcolor]",className:"col1-3"},{name:"Blue",openWith:"[bgcolor=blue]",closeWith:"[/bgcolor]",className:"col2-1"},{name:"Purple",openWith:"[bgcolor=purple]",closeWith:"[/bgcolor]",className:"col2-2"},{name:"Green",openWith:"[bgcolor=green]",closeWith:"[/bgcolor]",className:"col2-3"},{name:"White",openWith:"[bgcolor=white]",closeWith:"[/bgcolor]",className:"col3-1"},{name:"Gray",openWith:"[bgcolor=gray]",closeWith:"[/bgcolor]",className:"col3-2"},{name:"Black",openWith:"[bgcolor=black]",closeWith:"[/bgcolor]",className:"col3-3"}]},{separator:"---------------"},{name:"Picture",key:"P",replaceWith:"[img][![Image url]!][/img]"},{name:"Link",key:"L",openWith:"[url=[![Link url]!]]",closeWith:"[/url]",placeHolder:"Your text to link here..."},{separator:"---------------"},{name:"Bulleted list",openWith:"[list]\n",closeWith:"\n[/list]"},{name:"Numeric list",openWith:"[list=[![Starting number]!]]\n",closeWith:"\n[/list]"},{name:"List item",openWith:"[*] "},{separator:"---------------"},{name:"Quotes",openWith:"[quote]",closeWith:"[/quote]"},{name:"Code",openWith:"[code]",closeWith:"[/code]"},{separator:"---------------"},{name:"Smiley",className:"smiley",call:"preview"},{name:"YouTube Video",className:"youtube",openWith:"[youtube]",closeWith:"[/youtube]"},{name:"TuDou Video",className:"tudou",openWith:"[tudou]",closeWith:"[/tudou]"},{separator:"---------------"},{name:"Clean",className:"clean",replaceWith:function(a){return a.selection.replace(/\[(.*?)\]/g,"")}},{name:"Preview",className:"preview",call:"preview"},{name:"Help",className:"help",call:"preview"}]};(function(a){a.fn.hoverIntent=function(n,d,h){var k={interval:100,sensitivity:7,timeout:0};if(typeof n==="object"){k=a.extend(k,n)}else{if(a.isFunction(d)){k=a.extend(k,{over:n,out:d,selector:h})}else{k=a.extend(k,{over:n,out:n,selector:d})}}var m,l,g,f;var e=function(o){m=o.pageX;l=o.pageY};var c=function(p,o){o.hoverIntent_t=clearTimeout(o.hoverIntent_t);if((Math.abs(g-m)+Math.abs(f-l))<k.sensitivity){a(o).off("mousemove.hoverIntent",e);o.hoverIntent_s=1;return k.over.apply(o,[p])}else{g=m;f=l;o.hoverIntent_t=setTimeout(function(){c(p,o)},k.interval)}};var j=function(p,o){o.hoverIntent_t=clearTimeout(o.hoverIntent_t);o.hoverIntent_s=0;return k.out.apply(o,[p])};var b=function(q){var p=jQuery.extend({},q);var o=this;if(o.hoverIntent_t){o.hoverIntent_t=clearTimeout(o.hoverIntent_t)}if(q.type=="mouseenter"){g=p.pageX;f=p.pageY;a(o).on("mousemove.hoverIntent",e);if(o.hoverIntent_s!=1){o.hoverIntent_t=setTimeout(function(){c(p,o)},k.interval)}}else{a(o).off("mousemove.hoverIntent",e);if(o.hoverIntent_s==1){o.hoverIntent_t=setTimeout(function(){j(p,o)},k.timeout)}}};return this.on({"mouseenter.hoverIntent":b,"mouseleave.hoverIntent":b},k.selector)}})(jQuery);(function(b){var a=(function(){var q={bcClass:"sf-breadcrumb",menuClass:"sf-js-enabled",anchorClass:"sf-with-ul",menuArrowClass:"sf-arrows"},f=/iPhone|iPad|iPod/i.test(navigator.userAgent),l=(function(){var c=document.documentElement.style;return("behavior" in c&&"fill" in c&&/iemobile/i.test(navigator.userAgent))})(),d=(function(){if(f){b(window).load(function(){b("body").children().on("click",b.noop)})}})(),n=function(t,u){var c=q.menuClass;if(u.cssArrows){c+=" "+q.menuArrowClass}t.toggleClass(c)},s=function(c,t){return c.find("li."+t.pathClass).slice(0,t.pathLevels).addClass(t.hoverClass+" "+q.bcClass).filter(function(){return(b(this).children("ul").hide().show().length)}).removeClass(t.pathClass)},o=function(c){c.children("a").toggleClass(q.anchorClass)},g=function(c){var t=c.css("ms-touch-action");t=(t==="pan-y")?"auto":"pan-y";c.css("ms-touch-action",t)},k=function(u,v){var c="li:has(ul)";if(b.fn.hoverIntent&&!v.disableHI){u.hoverIntent(m,h,c)}else{u.on("mouseenter.superfish",c,m).on("mouseleave.superfish",c,h)}var t="MSPointerDown.superfish";if(!f){t+=" touchend.superfish"}if(l){t+=" mousedown.superfish"}u.on("focusin.superfish","li",m).on("focusout.superfish","li",h).on(t,"a",j)},j=function(u){var t=b(this),c=t.siblings("ul");if(c.length>0&&c.is(":hidden")){t.one("click.superfish",false);if(u.type==="MSPointerDown"){t.trigger("focus")}else{b.proxy(m,t.parent("li"))()}}},m=function(){var c=b(this),t=p(c);clearTimeout(t.sfTimer);c.siblings().superfish("hide").end().superfish("show")},h=function(){var c=b(this),t=p(c);if(f){b.proxy(r,c,t)()}else{clearTimeout(t.sfTimer);t.sfTimer=setTimeout(b.proxy(r,c,t),t.delay)}},r=function(c){c.retainPath=(b.inArray(this[0],c.$path)>-1);this.superfish("hide");if(!this.parents("."+c.hoverClass).length){c.onIdle.call(e(this));if(c.$path.length){b.proxy(m,c.$path)()}}},e=function(c){return c.closest("."+q.menuClass)},p=function(c){return e(c).data("sf-options")};return{hide:function(t){if(this.length){var w=this,x=p(w);if(!x){return this}var u=(x.retainPath===true)?x.$path:"",c=w.find("li."+x.hoverClass).add(this).not(u).removeClass(x.hoverClass).children("ul"),v=x.speedOut;if(t){c.show();v=0}x.retainPath=false;x.onBeforeHide.call(c);c.stop(true,true).animate(x.animationOut,v,function(){var y=b(this);x.onHide.call(y)})}return this},show:function(){var u=p(this);if(!u){return this}var t=this.addClass(u.hoverClass),c=t.children("ul");u.onBeforeShow.call(c);c.stop(true,true).animate(u.animation,u.speed,function(){u.onShow.call(c)});return this},destroy:function(){return this.each(function(){var t=b(this),u=t.data("sf-options"),c=t.find("li:has(ul)");if(!u){return false}clearTimeout(u.sfTimer);n(t,u);o(c);g(t);t.off(".superfish").off(".hoverIntent");c.children("ul").attr("style",function(v,w){return w.replace(/display[^;]+;?/g,"")});u.$path.removeClass(u.hoverClass+" "+q.bcClass).addClass(u.pathClass);t.find("."+u.hoverClass).removeClass(u.hoverClass);u.onDestroy.call(t);t.removeData("sf-options")})},init:function(c){return this.each(function(){var u=b(this);if(u.data("sf-options")){return false}var v=b.extend({},b.fn.superfish.defaults,c),t=u.find("li:has(ul)");v.$path=s(u,v);u.data("sf-options",v);n(u,v);o(t);g(u);k(u,v);t.not("."+q.bcClass).superfish("hide",true);v.onInit.call(this)})}}})();b.fn.superfish=function(d,c){if(a[d]){return a[d].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof d==="object"||!d){return a.init.apply(this,arguments)}else{return b.error("Method "+d+" does not exist on jQuery.fn.superfish")}}};b.fn.superfish.defaults={hoverClass:"sfHover",pathClass:"overrideThisToUse",pathLevels:1,delay:800,animation:{opacity:"show"},animationOut:{opacity:"hide"},speed:"normal",speedOut:"fast",cssArrows:true,disableHI:false,onInit:b.noop,onBeforeShow:b.noop,onShow:b.noop,onBeforeHide:b.noop,onHide:b.noop,onIdle:b.noop,onDestroy:b.noop};b.fn.extend({hideSuperfishUl:a.hide,showSuperfishUl:a.show})})(jQuery);(function(f){var e=[],c=[],k=[],m=[],d=[],h=[],b=[],g=[],l=[],a=[],j=[];f.fn.coinslider=f.fn.CoinSlider=function(A){var r=function(E){var I=parseInt(e[E.id].width/e[E.id].spw),D=I,L=parseInt(e[E.id].height/e[E.id].sph),H=L,C=0,J=0,K=0,G,F,N=e[E.id].width-e[E.id].spw*D,B=N,M=e[E.id].height-e[E.id].sph*H,O=M;for(G=1;G<=e[E.id].sph;G++){B=N;if(O>0){O--;H=L+1}else{H=L}for(F=1;F<=e[E.id].spw;F++){if(B>0){B--;D=I+1}else{D=I}c[E.id][C]=G+""+F;C++;if(e[E.id].links){f("#"+E.id).append("<a href='"+m[E.id][0]+"' class='cs-"+E.id+"' id='cs-"+E.id+G+F+"' style='width:"+D+"px; height:"+H+"px; float: left; position: absolute;'></a>")}else{f("#"+E.id).append("<div class='cs-"+E.id+"' id='cs-"+E.id+G+F+"' style='width:"+D+"px; height:"+H+"px; float: left; position: absolute;'></div>")}f("#cs-"+E.id+G+F).css({"background-position":"center center",left:J,top:K});J+=D}K+=H;J=0}if(!e[E.id].navigationPrevNextAlwaysShown){f(".cs-"+E.id).mouseover(function(){f("#cs-navigation-"+E.id).show()});f(".cs-"+E.id).mouseout(function(){f("#cs-navigation-"+E.id).hide()});f("#cs-title-"+E.id).mouseover(function(){f("#cs-navigation-"+E.id).show()});f("#cs-title-"+E.id).mouseout(function(){f("#cs-navigation-"+E.id).hide()})}if(e[E.id].hoverPause){f(".cs-"+E.id).mouseover(function(){e[E.id].pause=true});f(".cs-"+E.id).mouseout(function(){e[E.id].pause=false});f("#cs-title-"+E.id).mouseover(function(){e[E.id].pause=true});f("#cs-title-"+E.id).mouseout(function(){e[E.id].pause=false})}if(e[E.id].blurPause){f(window).blur(function(){clearInterval(b[E.id])});f(window).focus(function(){y(E)})}};var y=function(C){clearInterval(b[C.id]);var B=e[C.id].delay+e[C.id].spw*e[C.id].sph*e[C.id].sDelay;b[C.id]=setInterval(function(){v(C)},B)};var v=function(B,C){if(e[B.id].pause===true){return}z(B);a[B.id]=0;l[B.id]=setInterval(function(){o(B,c[B.id][a[B.id]])},e[B.id].sDelay);f(B).css({"background-image":"url("+k[B.id][g[B.id]]+")"});if(typeof(C)=="undefined"){g[B.id]++}else{if(C=="prev"){g[B.id]--}else{g[B.id]=C}}if(g[B.id]==k[B.id].length){g[B.id]=0}if(g[B.id]==-1){g[B.id]=k[B.id].length-1}f(".cs-button-"+B.id).removeClass("cs-active");f("#cs-button-"+B.id+"-"+(g[B.id]+1)).addClass("cs-active");if(h[B.id][g[B.id]]){f("#cs-title-"+B.id).css({opacity:0}).animate({opacity:e[B.id].opacity},e[B.id].titleSpeed);f("#cs-title-"+B.id).html(h[B.id][g[B.id]])}else{f("#cs-title-"+B.id).css("opacity",0)}};var o=function(C,B){f(".cs-"+C.id).attr("href",m[C.id][g[C.id]]).attr("target",d[C.id][g[C.id]]);if(a[C.id]==e[C.id].spw*e[C.id].sph){clearInterval(l[C.id]);return}f("#cs-"+C.id+B).css({opacity:0,"background-image":"url("+k[C.id][g[C.id]]+")"});f("#cs-"+C.id+B).animate({opacity:1},300);a[C.id]++};var p=function(C){if(e[C.id].showNavigationPrevNext){f(C).append("<div id='cs-navigation-"+C.id+"'></div>");if(!e[C.id].navigationPrevNextAlwaysShown){f("#cs-navigation-"+C.id).hide()}f("#cs-navigation-"+C.id).append("<a href='#' id='cs-prev-"+C.id+"' class='cs-prev'>"+e[C.id].prevText+"</a>");f("#cs-navigation-"+C.id).append("<a href='#' id='cs-next-"+C.id+"' class='cs-next'>"+e[C.id].nextText+"</a>");f("#cs-prev-"+C.id).css({position:"absolute",top:e[C.id].height/2-15,left:0,"z-index":1001,"line-height":"30px",opacity:e[C.id].opacity}).click(function(D){D.preventDefault();v(C,"prev");y(C)}).mouseover(function(){f("#cs-navigation-"+C.id).show()});f("#cs-next-"+C.id).css({position:"absolute",top:e[C.id].height/2-15,right:0,"z-index":1001,"line-height":"30px",opacity:e[C.id].opacity}).click(function(D){D.preventDefault();v(C);y(C)}).mouseover(function(){f("#cs-navigation-"+C.id).show()});f("#cs-navigation-"+C.id+" a").mouseout(function(){if(!e[C.id].navigationPrevNextAlwaysShown){f("#cs-navigation-"+C.id).hide()}e[C.id].pause=false})}if(e[C.id].showNavigationButtons){f(C).append("<div id='cs-buttons-"+C.id+"' class='cs-buttons'></div>");var B;for(B=1;B<k[C.id].length+1;B++){f("#cs-buttons-"+C.id).append("<a href='#' class='cs-button-"+C.id+"' id='cs-button-"+C.id+"-"+B+"'>"+B+"</a>")}f.each(f(".cs-button-"+C.id),function(D,E){f(E).click(function(F){f(".cs-button-"+C.id).removeClass("cs-active");f(this).addClass("cs-active");F.preventDefault();v(C,D);y(C)})});f("#cs-buttons-"+C.id).css({left:"50%","margin-left":-k[C.id].length*15/2-5,position:"absolute",top:"5px","z-index":1001})}};var z=function(F){var G=["random","swirl","rain","straight"],D,C,B,E;if(e[F.id].effect===""){E=G[Math.floor(Math.random()*(G.length))]}else{E=e[F.id].effect}c[F.id]=[];if(E=="random"){B=0;for(D=1;D<=e[F.id].sph;D++){for(C=1;C<=e[F.id].spw;C++){c[F.id][B]=D+""+C;B++}}q(c[F.id])}if(E=="rain"){n(F)}if(E=="swirl"){t(F)}if(E=="straight"){u(F)}j[F.id]*=-1;if(j[F.id]>0){c[F.id].reverse()}};var q=function(B){var D=B.length,C,F,E;if(D===0){return false}while(--D){C=Math.floor(Math.random()*(D+1));F=B[D];E=B[C];B[D]=E;B[C]=F}};var t=function(C){var E=e[C.id].sph,F=e[C.id].spw,L=1,K=1,D=0,H=0,J=0,B,I=true,G;while(I){H=(D===0||D===2)?F:E;for(G=1;G<=H;G++){c[C.id][J]=L+""+K;J++;if(G!=H){switch(D){case 0:K++;break;case 1:L++;break;case 2:K--;break;case 3:L--;break}}}D=(D+1)%4;switch(D){case 0:F--;K++;break;case 1:E--;L++;break;case 2:F--;K--;break;case 3:E--;L--;break}B=w(E,F)-s(E,F);if(F<=B&&E<=B){I=false}}};var n=function(E){var I=e[E.id].sph,B=e[E.id].spw,H=0,G=1,C=1,F=1,D=true;while(D){for(i=F;i<=G;i++){c[E.id][H]=i+""+parseInt(C-i+1);H++}C++;if(G<I&&C<B&&I<B){G++}if(G<I&&I>=B){G++}if(C>B){F++}if(F>G){D=false}}};var u=function(E){var B=0,D,C;for(D=1;D<=e[E.id].sph;D++){for(C=1;C<=e[E.id].spw;C++){c[E.id][B]=D+""+C;B++}}};var s=function(C,B){if(C>B){return B}else{return C}};var w=function(C,B){if(C<B){return B}else{return C}};var x=function(B){c[B.id]=[];k[B.id]=[];m[B.id]=[];d[B.id]=[];h[B.id]=[];g[B.id]=0;a[B.id]=0;j[B.id]=1;e[B.id]=f.extend({},f.fn.coinslider.defaults,A);f.each(f("#"+B.id+" img"),function(C,D){k[B.id][C]=f(D).attr("data-src");m[B.id][C]=f(D).parent().is("a")?f(D).parent().attr("href"):"";d[B.id][C]=f(D).parent().is("a")?f(D).parent().attr("target"):"";h[B.id][C]=f(D).attr("alt");f(D).hide()});f(B).css({"background-image":"url("+k[B.id][0]+")",width:e[B.id].width,height:e[B.id].height,position:"relative","background-position":"center center"}).wrap("<div class='coin-slider' id='coin-slider-"+B.id+"' />");f("#"+B.id).append("<div class='cs-title' id='cs-title-"+B.id+"' style='position: absolute; bottom:0; left: 0; z-index: 1000;'></div>");r(B);if(e[B.id].navigation){p(B)}v(B,0);y(B)};this.each(function(){x(this)})};f.fn.coinslider.defaults={width:600,height:300,spw:1,sph:1,delay:5000,sDelay:50,opacity:0.7,titleSpeed:1000,effect:"straight",links:true,hoverPause:true,blurPause:true,prevText:"<",nextText:">",navigation:true,showNavigationPrevNext:true,showNavigationButtons:true,navigationPrevNextAlwaysShown:false}})(jQuery);(function($){$.extend({metadata:{defaults:{type:"class",name:"metadata",cre:/({.*})/,single:"metadata"},setType:function(type,name){this.defaults.type=type;this.defaults.name=name},get:function(elem,opts){var settings=$.extend({},this.defaults,opts);if(!settings.single.length){settings.single="metadata"}var data=$.data(elem,settings.single);if(data){return data}data="{}";if(settings.type=="class"){var m=settings.cre.exec(elem.className);if(m){data=m[1]}}else{if(settings.type=="elem"){if(!elem.getElementsByTagName){return}var e=elem.getElementsByTagName(settings.name);if(e.length){data=$.trim(e[0].innerHTML)}}else{if(elem.getAttribute!=undefined){var attr=elem.getAttribute(settings.name);if(attr){data=attr}}}}if(data.indexOf("{")<0){data="{"+data+"}"}data=eval("("+data+")");$.data(elem,settings.single,data);return data}}});$.fn.metadata=function(opts){return $.metadata.get(this[0],opts)}})(jQuery);if(window.jQuery){(function(a){if((!a.support.opacity&&!a.support.style)){try{document.execCommand("BackgroundImageCache",false,true)}catch(b){}}a.fn.rating=function(d){if(this.length==0){return this}if(typeof arguments[0]=="string"){if(this.length>1){var c=arguments;return this.each(function(){a.fn.rating.apply(a(this),c)})}a.fn.rating[arguments[0]].apply(this,a.makeArray(arguments).slice(1)||[]);return this}var d=a.extend({},a.fn.rating.options,d||{});a.fn.rating.calls++;this.not(".star-rating-applied").addClass("star-rating-applied").each(function(){var g,m=a(this);var e=(this.name||"unnamed-rating").replace(/\[|\]/g,"_").replace(/^\_+|\_+$/g,"");var f=a(this.form||document.body);var l=f.data("rating");if(!l||l.call!=a.fn.rating.calls){l={count:0,call:a.fn.rating.calls}}var o=l[e]||f.data("rating"+e);if(o){g=o.data("rating")}if(o&&g){g.count++}else{g=a.extend({},d||{},(a.metadata?m.metadata():(a.meta?m.data():null))||{},{count:0,stars:[],inputs:[]});g.serial=l.count++;o=a('<span class="star-rating-control"/>');m.before(o);o.addClass("rating-to-be-drawn");if(m.attr("disabled")||m.hasClass("disabled")){g.readOnly=true}if(m.hasClass("required")){g.required=true}o.append(g.cancel=a('<div class="rating-cancel"><a title="'+g.cancel+'">'+g.cancelValue+"</a></div>").on("mouseover",function(){a(this).rating("drain");a(this).addClass("star-rating-hover")}).on("mouseout",function(){a(this).rating("draw");a(this).removeClass("star-rating-hover")}).on("click",function(){a(this).rating("select")}).data("rating",g))}var k=a('<div role="text" aria-label="'+this.title+'" class="star-rating rater-'+g.serial+'"><a title="'+(this.title||this.value)+'">'+this.value+"</a></div>");o.append(k);if(this.id){k.attr("id",this.id)}if(this.className){k.addClass(this.className)}if(g.half){g.split=2}if(typeof g.split=="number"&&g.split>0){var j=(a.fn.width?k.width():0)||g.starWidth;var h=(g.count%g.split),n=Math.floor(j/g.split);k.width(n).find("a").css({"margin-left":"-"+(h*n)+"px"})}if(g.readOnly){k.addClass("star-rating-readonly")}else{k.addClass("star-rating-live").on("mouseover",function(){a(this).rating("fill");a(this).rating("focus")}).on("mouseout",function(){a(this).rating("draw");a(this).rating("blur")}).on("click",function(){a(this).rating("select")})}if(this.checked){g.current=k}if(this.nodeName=="A"){if(a(this).hasClass("selected")){g.current=k}}m.hide();m.on("change.rating",function(p){if(p.selfTriggered){return false}a(this).rating("select")});k.data("rating.input",m.data("rating.star",k));g.stars[g.stars.length]=k[0];g.inputs[g.inputs.length]=m[0];g.rater=l[e]=o;g.context=f;m.data("rating",g);o.data("rating",g);k.data("rating",g);f.data("rating",l);f.data("rating"+e,o)});a(".rating-to-be-drawn").rating("draw").removeClass("rating-to-be-drawn");return this};a.extend(a.fn.rating,{calls:0,focus:function(){var d=this.data("rating");if(!d){return this}if(!d.focus){return this}var c=a(this).data("rating.input")||a(this.tagName=="INPUT"?this:null);if(d.focus){d.focus.apply(c[0],[c.val(),a("a",c.data("rating.star"))[0]])}},blur:function(){var d=this.data("rating");if(!d){return this}if(!d.blur){return this}var c=a(this).data("rating.input")||a(this.tagName=="INPUT"?this:null);if(d.blur){d.blur.apply(c[0],[c.val(),a("a",c.data("rating.star"))[0]])}},fill:function(){var c=this.data("rating");if(!c){return this}if(c.readOnly){return}this.rating("drain");this.prevAll().addBack().filter(".rater-"+c.serial).addClass("star-rating-hover")},drain:function(){var c=this.data("rating");if(!c){return this}if(c.readOnly){return}c.rater.children().filter(".rater-"+c.serial).removeClass("star-rating-on").removeClass("star-rating-hover")},draw:function(){var e=this.data("rating");if(!e){return this}this.rating("drain");var d=a(e.current);var c=d.length?d.prevAll().addBack().filter(".rater-"+e.serial):null;if(c){c.addClass("star-rating-on")}e.cancel[e.readOnly||e.required?"hide":"show"]();this.siblings()[e.readOnly?"addClass":"removeClass"]("star-rating-readonly")},select:function(d,g){var f=this.data("rating");if(!f){return this}if(f.readOnly){return}f.current=null;if(typeof d!="undefined"||this.length>1){if(typeof d=="number"){return a(f.stars[d]).rating("select",undefined,g)}if(typeof d=="string"){a.each(f.stars,function(){if(a(this).data("rating.input").val()==d){a(this).rating("select",undefined,g)}});return this}}else{f.current=this[0].tagName=="INPUT"?this.data("rating.star"):(this.is(".rater-"+f.serial)?this:null)}this.data("rating",f);this.rating("draw");var e=a(f.current?f.current.data("rating.input"):null);var c=a(f.inputs).filter(":checked");var h=a(f.inputs).not(e);h.prop("checked",false);e.prop("checked",true);a(e.length?e:c).trigger({type:"change",selfTriggered:true});if((g||g==undefined)&&f.callback){f.callback.apply(e[0],[e.val(),a("a",f.current)[0]])}return this},readOnly:function(c,d){var e=this.data("rating");if(!e){return this}e.readOnly=c||c==undefined?true:false;if(d){a(e.inputs).attr("disabled","disabled")}else{a(e.inputs).removeAttr("disabled")}this.data("rating",e);this.rating("draw")},disable:function(){this.rating("readOnly",true,true)},enable:function(){this.rating("readOnly",false,false)}});a.fn.rating.options={cancel:"Cancel Rating",cancelValue:"",split:0,starWidth:16};a(function(){a("input[type=radio].star").rating()})})(jQuery)}var UMODE_PC="pc",UMODE_MOBILE="mobile",UROLE_GUEST="guest",UROLE_USER="user",UROLE_ADM="adm";$.cookie.defaults={expires:365,path:"/",domain:document.domain.split(".").slice(-2).join(".")};if($.cookie("umode")==UMODE_MOBILE){document.write('<meta name="viewport" content="width=device-width, initial-scale=1.0" />')}$(document).ready(function(){var f=$.cookie("urole"),g=$.cookie("umode"),m=$.cookie("uid"),a=(window&&window.navigator&&window.navigator.userAgent)?window.navigator.userAgent:"";if(m==0&&f!==UROLE_GUEST){f=UROLE_GUEST}if(m>0){$('[data-urole="'+UROLE_GUEST+'"]').remove();$('[data-urole="'+UROLE_USER+'"]').show();$('[data-urole$="'+UROLE_USER+m+'"]').show();if(f.substring(0,3)===UROLE_ADM){if(f===UROLE_ADM){$('[data-urole^="'+UROLE_ADM+'"]').show()}else{$('[data-urole^="'+f+'"]').show()}}}else{$('[data-urole^="'+UROLE_ADM+'"]').remove();$('[data-urole^="'+UROLE_USER+'"]').remove();$('[data-urole="'+UROLE_GUEST+'"]').show()}if(g!==UMODE_PC&&g!==UMODE_MOBILE){g=(a.search(/(iPhone|Android|BlackBerry)/)>=0?UMODE_MOBILE:UMODE_PC)}if(g===UMODE_PC){$('[data-umode="'+UMODE_MOBILE+'"]').remove();$('[data-umode="'+UMODE_PC+'"]').show();$("ul#navbar-menu").superfish();$("#coin-slider").coinslider();$(".forum-post-wrapper").each(function(){var q=$(".forum-post-panel",this).first();var p=$(".forum-post-main",this).first();var o=q.outerHeight()-p.outerHeight();if(o>0){$(".post-content",p).css("padding-bottom","+="+o)}})}else{$('[data-umode="'+UMODE_PC+'"]').remove();$('[data-umode="'+UMODE_MOBILE+'"]').show();$("div#navbar_user").css("float","none");var b=$("ul#navbar-menu").detach().appendTo("div#page_navbar_mobile").removeClass().css("list-style-type","none");b.find("ul").show().css("list-style-type","none");b.find("a.sf-with-ul").removeClass();$("#coin-slider").remove();$("div#page_header").css("width","100%");$("div#page_body").css("width","100%");$("div#page_footer").css("width","100%");$("div.item-list").css("width","100%").css("float","none");$("div.forum-post-main").css("width","100%").css("margin-left","0").css("clear","both")}$(".js_even_odd_parent").each(function(){var o=$(this).children();o.filter(":even").addClass("even");o.filter(":odd").addClass("odd")});if(f!==UROLE_GUEST){var l=$("#BBCodeEditor");var d=$("#edit-title");var c=$("#editor-div");var j=$("#editor-form");var n=$("#ajax-file-list");var k=$("tbody",n);var e=$("#TextEditor");var h=$.cookie("pmCount");if(h>0){$("a#pm").append('<span style="color:red;"> ('+h+") <span>")}l.markItUp(mySettings);$("a.bb-quote").click(function(q){q.preventDefault();d.hide();j.attr("action",$(this).attr("href"));n.hide();k.children().remove();l.val("");window.scrollTo(0,c.offset().top);l.focus();var p=$("#"+$(this).attr("id").replace("quote","raw"));var o=p.find("span.username").html();var r='[quote="'+o+'"]'+p.find("pre.postbody").html()+"[/quote]\n";$.markItUp({replaceWith:r})});$("a.bb-reply").click(function(o){o.preventDefault();d.hide();j.attr("action",$(this).attr("href"));n.hide();k.children().remove();l.val("");window.scrollTo(0,c.offset().top);l.focus()});$("a.bb-edit").click(function(t){t.preventDefault();var p=$(this).attr("id");if(p.substr(0,p.indexOf("-"))==="node"){$("input",d).val($("#node-title").html());d.show()}else{d.hide()}j.attr("action",$(this).attr("href"));l.val("");window.scrollTo(0,c.offset().top);l.focus();var r=$("#"+p.replace("edit","raw"));var v=r.find("pre.postbody").html();$.markItUp({replaceWith:v});var o=$.parseJSON(r.find("span.files").html());if(o instanceof Array&&o.length>0){n.show();for(var s=0;s<o.length;s++){var q=o[s].fid;var z=o[s].path;var w=new Array("jpeg","gif","png");var y=z.split(".").pop();var u;if(w.indexOf(y)>=0){u="[img]"+z+"[/img]"}else{u='[file="'+z+'"]'+o[s].name+"[/file]"}var x='<tr id="editfile-'+q+'"><td><input type="text" maxlength="30" name="files['+q+'][name]" id="editfile-'+q+'-name" size="30" value="'+o[s].name+'" class="form-text"></td><td style="padding: 0 10px;">'+u+'<input type="text" style="display:none;" name="files['+q+'][path]" value="'+z+'"></td><td style="text-align: center;"><a href="/file/delete?id='+q+'" class="ajax-file-delete" id="editfile-'+q+'-delete">X</a></td></tr>';k.append(x)}}else{n.hide()}});$("a.bb-create-node").click(function(o){o.preventDefault();c.show();d.show();$("input",d).val("").focus();j.attr("action",$(this).attr("href"));n.hide();k.children().remove();l.val("");window.scrollTo(0,c.offset().top)});$("a.edit").click(function(p){p.preventDefault();j.attr("action",$(this).attr("href"));e.val("").focus();window.scrollTo(0,c.offset().top);var o=$("#"+$(this).attr("id").replace("edit","raw"));e.val(o.find("pre.postbody").html())});$("a.reply").click(function(o){o.preventDefault();j.attr("action",$(this).attr("href"));e.val("").focus();window.scrollTo(0,c.offset().top)});$("a.delete").click(function(p){var o=confirm("此操作不可恢复，您确认要删除该内容吗？");if(!o){p.preventDefault()}});$("#ajax-file-upload").click(function(p){var o=$("#ajax-file-select");if(o.val().length>0){o.upload("/file/ajax/upload",function(t){try{if(t.error&&t.error.length>0){var q="";if(Object.prototype.toString.call(t.error)==="[object Array]"){for(var r=0;r<t.error.length;r++){q=q+t.error[r].name+" : "+t.error[r].error+"\n"}}else{q=t.error}alert(q)}if(t.saved&&t.saved.length>0){n.show();for(var r=0;r<t.saved.length;r++){var x=t.saved[r].path;var v=new Array("jpeg","gif","png");var y=x.split(".").pop();var u;if(v.indexOf(y)>=0){u="[img]"+x+"[/img]"}else{u='[file="'+x+'"]'+t.saved[r].name+"[/file]"}var w='<tr id="editfile-'+x+'"><td><input type="text" maxlength="30" name="files['+x+'][name]" id="editfile-'+x+'-name" size="30" value="'+t.saved[r].name+'" class="form-text"></td><td style="padding: 0 10px;">'+u+'<input type="text" style="display:none;" name="files['+x+'][path]" value="'+x+'"></td><td style="text-align: center;"><a href="/file/delete?id='+x+'" class="ajax-file-delete" id="editfile-'+x+'-delete">X</a></td></tr>';k.append(w)}}}catch(s){alert("您的浏览器在上传文件过程中遇到错误，请换用其他浏览器上传文件。");$.post("/bug/ajax-file-upload","error="+s.message+"&res="+encodeURIComponent(t))}},"json")}});n.on("click",".ajax-file-delete",function(p){p.preventDefault();var q=this.parentNode.parentNode;var o=q.parentNode.parentNode;o.deleteRow(q.rowIndex);if(o.rows.length<=1){n.hide()}})}$("a.view_switch").click(function(p){var o=$(this).attr("href");if(o.length>1){$.cookie("umode",o.substring(1));$(this).attr("href",window.location.pathname)}else{p.preventDefault()}})});
